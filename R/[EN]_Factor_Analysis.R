## -----------------------------------------------------------------------------------------------------------
# R Packages
packages <-
  c("tidyverse",
    "ggplot2",
    "rstatix",
    "pander",
    "heplots",
    "readr",
    "psych",
    "corrplot")

suppressPackageStartupMessages(lapply(packages, require, character.only = TRUE))

# Importing Data
df <- read.csv("./dataset/data.csv", sep = ";")


# for kaggle
# df <- read.csv("../input/airline-passenger-satisfaction/train.csv, sep = ";")

# Top 6 rows
head(df)


## -----------------------------------------------------------------------------------------------------------
class(df)


## -----------------------------------------------------------------------------------------------------------
# Structure of the data frame
str(df)


## -----------------------------------------------------------------------------------------------------------
print(sapply(df, class))


## -----------------------------------------------------------------------------------------------------------
# To convert all integer columns to numeric columns

df <- df %>% mutate_if(is.integer, as.numeric)

print(sapply(df, class))


## -----------------------------------------------------------------------------------------------------------
dim(df)


## -----------------------------------------------------------------------------------------------------------
# Structure of the data frame
str(df)


## -----------------------------------------------------------------------------------------------------------
# checking for any missing values in a dataframe
any(is.na(df))


## -----------------------------------------------------------------------------------------------------------
# Count of missing values
sum(is.na(df))


## -----------------------------------------------------------------------------------------------------------
#Position of missing values by column
sapply(df, function(x) which(is.na(x)))

df$ArrivalDelayinMinutes[is.na(df$ArrivalDelayinMinutes)] <- 0

any(is.na(df))


## -----------------------------------------------------------------------------------------------------------
# Statistical summary
summary(df)


## -----------------------------------------------------------------------------------------------------------
data_01 <- df %>%
  as.data.frame() %>%
  dplyr::select(09:22)

data_cor <- data_01 %>%
  as.matrix() %>%
  cor() 


## -----------------------------------------------------------------------------------------------------------
view(list(data_cor))


## -----------------------------------------------------------------------------------------------------------
corrplot(data_cor,
         method = "number",
         col = colorRampPalette(c("white", "#85C1E9", "#4A235A"))(100))


## -----------------------------------------------------------------------------------------------------------
corrplot(data_cor,
         method = "color")


## -----------------------------------------------------------------------------------------------------------
# Kaiser-Meyer-Olkin Measure of Sampling Adequacy
KMO(data_cor)


## -----------------------------------------------------------------------------------------------------------
# Bartlett's Test of Sphericity
cortest.bartlett(data_cor, n = nrow(df))


## -----------------------------------------------------------------------------------------------------------
# Anti-image Covariance

view(KMO(data_cor)$ImCov)


## -----------------------------------------------------------------------------------------------------------
# Anti-image Correlation
library(multiUS)
view(antiImage(X = data_01))


## -----------------------------------------------------------------------------------------------------------
scree(data_cor, factors = FALSE)


## -----------------------------------------------------------------------------------------------------------
parallel <- fa.parallel(data_01)


## -----------------------------------------------------------------------------------------------------------
data.fa <- principal(data_cor, nfactors = 3, rotate = "varimax")

data.fa$loadings


## -----------------------------------------------------------------------------------------------------------

print.psych(data.fa, sort = TRUE)


#ICLUST.sort(data.fa$loadings,labels = NULL,keys = FALSE,clustsort = TRUE)



## -----------------------------------------------------------------------------------------------------------
fa.diagram(data.fa)


## -----------------------------------------------------------------------------------------------------------
library(ltm)

rc1_alpha <- data_01[, c("v14",  "v7", "v5", "v8")]
rc3_alpha <- data_01[, c("v13", "v11", "v9", "v10")]
rc2_alpha <- data_01[, c("v3", "v1", "v4", "v2")]


# rc = rotated component
cronbach.alpha(rc1_alpha)
cronbach.alpha(rc3_alpha)
cronbach.alpha(rc2_alpha)